<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
    <H1>게시판(CRUD 기능 구성)</H1>
    <p>user의 기본정보(이름, 성별, 나이, 주소)를 조회할 수 있습니다.<br>
        또한 체크박스를 통해 값을 받아와서 해당하는 정보를 수정, 삭제가 가능하며<br>
        새로운 user를 추가할 수 있습니다.(등록)
    </p>
    <button id="insertBtn" th:onclick="|location.href='@{/board/board_insert}'|">등록</button>
    <button id="updateBtn" th:onclick="|location.href='@{/board/board_update}'|">수정</button>
    <button id="deleteBtn">삭제</button>
    <br>
    <br>
    <table class="tg" style="border: 1px solid black; width: 1000px; height: 100%; text-align: center; ">
        <thead>
        <tr>
            <th style="border: 1px solid black;" class="tg-0pky">구분</th>
            <th style="border: 1px solid black;" class="tg-0lax">번호</th>
            <th style="border: 1px solid black;" class="tg-0lax">이름</th>
            <th style="border: 1px solid black;" class="tg-0lax">성별</th>
            <th style="border: 1px solid black;" class="tg-0lax">나이</th>
            <th style="border: 1px solid black;" class="tg-0lax">주소</th>
            <th style="border: 1px solid black;" class="tg-0lax">최초등록날짜</th>
            <th style="border: 1px solid black;" class="tg-0lax">최근수정시간</th>
        </tr>
        </thead>
        <tbody id="addTable" style="border: 1px solid black;">

        </tbody>
    </table>
    <script type="text/javascript">

        // 삭제
        $("#deleteBtn").click(function () {

        });

        function selectList() {

            var addTable = $("#addTable");

            // 테이블 비우기
            addTable.empty();

            $.ajax({
                type: "POST",
                url : "selectList",
                async: true,
                dataType: 'json',
                success: function (res) {

                    res.data.selectList.forEach(function (data, index) {

                        let updateState = "";

                        if(data.modified_datetime == undefined) {
                            updateState = "수정 이력이 없습니다."
                        }

                        console.log(updateState)
                        var Table =
                            '<tr>'
                            + '<td style="border: 1px solid black; width: 5%;" class="tg-0lax">'
                            + '<input type="checkbox" name="checkValue" />'
                            + '</td>'
                            + '<td style="border: 1px solid black;" class="tg-0lax">' + data.id + '</td>'
                            + '<td style="border: 1px solid black;" class="tg-0lax">' + data.name + '</td>'
                            + '<td style="border: 1px solid black;" class="tg-0lax">' + data.gender + '</td>'
                            + '<td style="border: 1px solid black;" class="tg-0lax">' + data.age + '</td>'
                            + '<td style="border: 1px solid black;" class="tg-0lax">' + data.address + '</td>'
                            + '<td style="border: 1px solid black;" class="tg-0lax">' + data.reg_datetime + '</td>'
                            + '<td style="border: 1px solid black;" class="tg-0lax">' + updateState + '</td>'
                            + '</tr>'

                        addTable.append(Table);

                    });
                }
            });
        }

        selectList();
    </script>
</body>
</html>
